delta_true
beta_true
alpha_true
q=2
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
sim_data = getFormatData(sim_data,
feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))],
cluster_num = 3)
x = getStanFit (
c('sameC', 'sameA','dist'),
deltaM_value = 9,
option_num = 7,
sim_data,
save_model_file = NULL,
init_values = "random",
iter_num = 1500,
chain_num = 3,
warmup_num = 500,
core_num = 3,
adapt_delta = 0.999,
stepsize = 0.01,
max_treedepth = 20,
save_warmup = FALSE,
refresh = 500,
init_r = 0.5,
hier_value = 0
)
getParaSummary(x)
x = getStanFit (
c('sameC', 'sameA','dist'),
deltaM_value = 9,
option_num = 7,
sim_data,
save_model_file = NULL,
init_values = "random",
iter_num = 1500,
chain_num = 3,
warmup_num = 500,
core_num = 3,
adapt_delta = 0.999,
stepsize = 0.01,
max_treedepth = 20,
save_warmup = FALSE,
refresh = 500,
init_r = 0.5,
hier_value = 0
)
x
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
sim_data = getFormatData(sim_data,
feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))],
cluster_num = 3)
sim_data
x = getStanFit (
c('sameC', 'sameA','dist'),
deltaM_value = 9,
option_num = 7,
sim_data,
save_model_file = NULL,
init_values = "random",
iter_num = 1500,
chain_num = 3,
warmup_num = 500,
core_num = 3,
adapt_delta = 0.999,
stepsize = 0.01,
max_treedepth = 20,
save_warmup = FALSE,
refresh = 500,
init_r = 0.5,
hier_value = 0
)
getFormatData
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
devtools::load_all(".")
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
q=2
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
option_num=7
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
q=2
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
feature_data
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
feature_data
alpha_true = c(runif(option_num-1,-1,1),0)
alpha_true
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
question_num=250
question_num
feature_data
beta_true
beta_true = c(0,.5,-.5)
delta_true=.5
alpha_true
feature_data
option_num
question_num
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
sim_data = getFormatData(sim_data,
feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))],
cluster_num = 3)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
sim_data
feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
sim_data = getFormatData(sim_data,
feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))],
cluster_num = 3)
feature_mv
data_df
option_num
temp = feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
temp$qID=1
sim_data = getFormatData(sim_data,temp,cluster_num = 3)
x = getStanFit (
c('sameC', 'sameA','dist'),
deltaM_value = 9,
option_num = 7,
sim_data,
save_model_file = NULL,
init_values = "random",
iter_num = 1500,
chain_num = 3,
warmup_num = 500,
core_num = 3,
adapt_delta = 0.999,
stepsize = 0.01,
max_treedepth = 20,
save_warmup = FALSE,
refresh = 500,
init_r = 0.5,
hier_value = 0
)
getParaSummary(x)
feature_data
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == 3)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
q=3
temp
sim_data
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == q)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
temp = feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
temp$qID=1
sim_data = getFormatData(sim_data,temp,cluster_num = 3)
sim_data
sample_num = sample(1:12, size = question_num, replace = T)
feature_num = length(beta_true)
feature_num
N
sID = unlist(lapply(1:question_num, function(x)
rep(x, each = sample_num[x])))
tNo = unlist(lapply(sample_num, function(x)
1:x))
cID = rep(NA, each = N)
acc %*% beta_true
?%*%
#' Feature mattrix is dependent on the option sampled at the last time point
#' @param beta_true Values of beta vector (feature * 1)
#' @param delta_true Values of delta
#' @param alpha_true Values of alpha
#' @param feature_data feature matrix (option * feature);
#' dependent on the last chosen option
#' @param question_num totaal simulation number
#' @inheritParams  getStanFit
#' @export
#'
simulateChoice = function(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1) {
sample_num = sample(1:12, size = question_num, replace = T)
feature_num = length(beta_true)
N = sum(sample_num)
sID = unlist(lapply(1:question_num, function(x)
rep(x, each = sample_num[x])))
tNo = unlist(lapply(sample_num, function(x)
1:x))
cID = rep(NA, each = N)
base_p = softmax(alpha_true)
for (n in 1:N) {
if (tNo[n] == 1) {
acc = matrix(0, nrow = option_num, ncol = feature_num)
cID[n] = sample(1:option_num, size = 1, p = base_p)
} else{
acc = acc * delta_true + feature_data[[cID[n - 1]]]
prob = softmax(acc %*% beta_true + alpha_true)
cID[n] = sample(1:option_num, size = 1, p = prob)
}
}
return(data.frame(qID = 1, sID = sID, tNo = tNo, cID = cID))
}
feature_data
q
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == 2)
feature_data
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
feature_data
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
sim_data
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == 1)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
sim_data
temp
temp = feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
sim_data
temp
feature_data = subset(feature_data_8, qID == 1)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
temp = feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
temp$qID=1
sim_data = getFormatData(sim_data,temp,cluster_num = 3)
sim_data
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == 2)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
temp = feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
temp$qID=1
sim_data = getFormatData(sim_data,temp,cluster_num = 3)
sim_data
feature_data = subset(feature_data_8, qID == 3)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
temp = feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
temp$qID=1
sim_data = getFormatData(sim_data,temp,cluster_num = 3)
sim_data
getFormatData
devtools::load_all(".")
# feature_data_8 = cbind(read.csv('exp2_dist_C3.csv')[,2],
#                        do.call(rbind, replicate(8, cbind(diag(7), getSameA(3)),
#                                                 simplify=FALSE)),
#                        read.csv('exp2_dist_C3.csv')[,-c(1:2)])
# colnames(feature_data_8) = c('qID',unlist(lapply(c('sameC_','sameA_','dist_'), function(x) paste0(x,1:7))))
# head(feature_data_8)
### usethis::use_data(feature_data_8, overwrite = FALSE)
feature_data = subset(feature_data_8, qID == 3)
feature_data = getFeatureMatrices(
beta = c('sameC', 'sameA', 'dist'),
format_data = feature_data,
deltaM_value = 9,
option_num = 7
)
alpha_true = c(runif(option_num-1,-1,1),0)
sim_data = simulateChoice(beta_true,
delta_true,
alpha_true,
feature_data,
option_num,
question_num,
seed_no = 1)
temp = feature_data_8[feature_data_8$qID == q, c('qID', paste0('dist_', 1:option_num))]
temp$qID=1
sim_data = getFormatData(sim_data,temp,cluster_num = 3)
sim_data
x = getStanFit (
c('sameC', 'sameA','dist'),
deltaM_value = 9,
option_num = 7,
sim_data,
save_model_file = NULL,
init_values = "random",
iter_num = 1500,
chain_num = 3,
warmup_num = 500,
core_num = 3,
adapt_delta = 0.999,
stepsize = 0.01,
max_treedepth = 20,
save_warmup = FALSE,
refresh = 500,
init_r = 0.5,
hier_value = 0
)
hier_value = 0
)
getParaSummary(x)
sampinfo::getModelDiag(stan_data_fit = x)
